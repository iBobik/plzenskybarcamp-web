registerForm=function(e,t){$("#registration").on("click",e+" .registration-button",function(o){o.preventDefault(),form=$(".form",e),nextForm=$(".form",t),form.is(":visible")?(form.hide(),$.scrollTo(e)):(nextForm.hide(),form.show())})},registerAjaxRegistration=function(e){$(e).on("submit","form",function(t){form=this,t.preventDefault(),action=this.action,$("body").css("cursor","wait"),$.ajax({type:"POST",url:action,data:$(form).serialize()}).done(function(t){t.redirect&&$.ajax({type:"GET",url:t.redirect}).done(function(t){$("body").css("cursor","auto"),e.html(t.html),$.scrollTo(e)})})})},ajaxPost=function(e){return $.ajax({type:"POST",url:e.get(0).action,data:e.serialize()}).promise()},validateForms=function(e){for(index in e)if(!Nette.validateForm(e[index].get(0)))return $.Deferred().reject().promise();return e},commitForms=function(e){return commitForm=function(e){return ajaxPost(e).then(function(e){return e.updated?"Změny byly úspěšně uloženy":$.Deferred().reject("Během uloženi došlo k chybě").promise()})},$.when.apply($,e.map(commitForm))},showMessage=function(e,t){return function(o){o&&(elm=$('<p class="'+t+'">'+o+"</p>"),e.html("").append(elm),$.scrollTo(e,500),setTimeout(function(){elm.hide()},5e3))}},registerAjaxProfileUpdate=function(e,t,o,r,n){e.on("click",function(){r.show(),n.hide()}),t.on("click",function(){t.get(0).disabled=!0,forms=[$("form",o)],r.is(":visible")&&forms.push($("form",r)),unLockSave=function(e){return t.get(0).disabled=!1,e},messageContainer=$("#messages",o),$.when(validateForms(forms)).then(commitForms).then(unLockSave,unLockSave).done(showMessage(messageContainer,"success")).fail(showMessage(messageContainer,"error"))})},registerVotes=function(e){actionAdd=e.data("actionAdd"),actionRemove=e.data("actionRemove"),processSubmit=function(e,t){return action=e?actionAdd:actionRemove,$.ajax({type:"GET",url:action,data:"talkId="+t}).promise().then(function(e){return e.votes_count>=0?e.votes_count:$.Deferred().reject().promise()})},$("tr.talks-detail",e).each(function(e,t){t=$(t),talkId=t.data("id"),$(".vote",t).click(function(e){return function(o){o.preventDefault(),o.stopPropagation(),box=this,processSubmit(box.checked,e).done(function(e){$(".votes_count",t).html(e),box.checked=!box.checked})}}(talkId))})},$(document).ready(function(){setTimeout(function(){$(".flash.success").fadeOut(2e3)},3e3)}),$(document).ready(function(){$(".tooltip").tooltipster(),$("a").smoothScroll(),registerForm("#speaker-regestration","#user-regestration"),registerForm("#user-regestration","#speaker-regestration"),registerAjaxRegistration($("#registration")),registerAjaxProfileUpdate($("#talk-registration"),$("#profile-save"),$("#user-form"),$("#talk-form"),$("#talk-button")),registerVotes($("#talks-list"))}),$(document).ready(function(){var e=$(".table-list tr");e.on("click touchstart",function(){var t=$(this);t.hasClass("active")?t.removeClass("active").find(".crop").removeClass("more"):(e.removeClass("active").find(".crop").removeClass("more"),t.addClass("active").find(".crop").addClass("more"))});var t=$(".table-list#talks-list tr");t.on("click touchstart",function(e){var o=$(this),r=o.attr("data-id"),n=t.parent().find(".talks-head"),a=t.parent().find(".talks-detail"),i=t.parent().find('.talks-head[data-id="'+r+'"]'),s=t.parent().find('.talks-detail[data-id="'+r+'"]');$(e.target).is("a, a img")||(a.hide(),n.show(),o.hasClass("active-detail-head")?(i.show(),s.hide()):(i.hide(),s.addClass("active-detail").show()),o.hasClass("active-detail")&&(s.hide(),i.show()))})});