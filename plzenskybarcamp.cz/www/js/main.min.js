registerForm=function(e,t){$("#registration").on("click",e+" .registration-button",function(o){o.preventDefault(),$(this).hide();var i=$(".form",e),a=$(".form",t);i.is(":visible")?(i.hide(),$.scrollTo(e)):(a.hide(),i.show(),$.scrollTo(e,500))})},registerAjaxRegistration=function(e){$(e).on("submit","form",function(t){form=this,t.preventDefault(),action=this.action,$("body").css("cursor","wait"),$.ajax({type:"POST",url:action,data:$(form).serialize()}).done(function(t){t.redirect&&$.ajax({type:"GET",url:t.redirect}).done(function(t){$("body").css("cursor","auto"),e.html(t.html),$.scrollTo(e)})})})},ajaxPost=function(e){return $.ajax({type:"POST",url:e.get(0).action,data:e.serialize()}).promise()},validateForms=function(e){for(index in e)if(!Nette.validateForm(e[index].get(0)))return $.Deferred().reject().promise();return e},commitForms=function(e){return commitForm=function(e){return ajaxPost(e).then(function(e){return e.updated?"Změny byly úspěšně uloženy":$.Deferred().reject("Během uloženi došlo k chybě").promise()})},$.when.apply($,e.map(commitForm))},showMessage=function(e,t){return function(o){o&&(elm=$('<p class="js-message text-center '+t+'">'+o+"</p>"),e.html("").append(elm),$.scrollTo(e,500),setTimeout(function(){elm.hide()},5e3))}},registerAjaxProfileUpdate=function(e,t,o,i,a){e.on("click",function(){i.show(),a.hide()}),t.on("click",function(){t.get(0).disabled=!0,forms=[$("form",o)],i.is(":visible")&&forms.push($("form",i)),unLockSave=function(e){return t.get(0).disabled=!1,e},messageContainer=$("#messages",o),$.when(validateForms(forms)).then(commitForms).then(unLockSave,unLockSave).done(showMessage(messageContainer,"success")).fail(showMessage(messageContainer,"error"))})},processVote=function(e){return actionAdd=e.data("actionAdd"),actionRemove=e.data("actionRemove"),function(e,t){return action=e?actionAdd:actionRemove,$.ajax({type:"GET",url:action,data:"talkId="+t}).promise().then(function(e){return e.votes_count>=0?e.votes_count:$.Deferred().reject().promise()})}},registerVotes=function(e){checkins={},processSubmit=processVote(e),$("tr.talks-detail",e).each(function(e,t){t=$(t),talkId=t.data("id"),checkins[talkId]=$(".vote",t).data("checked"),boxs=[$(".vote",t),$(".vote",t.prev())],$.each(boxs,function(e,o){o.prop("checked",checkins[talkId]),$(o).click(function(e,t,o,i){return function(a){a.preventDefault(),a.stopPropagation(),processSubmit(!checkins[e],e).done(function(a){o.html(a),checkins[e]=!checkins[e],$.each(t,function(t,o){o.prop("checked",checkins[e])}),checkins[e]?i.addClass("voted-for"):i.removeClass("voted-for")})}}(talkId,boxs,$(".votes_count",t),t.prev()))})})},registerVotesDetail=function(e){e.get(0)&&(checkins={},processSubmit=processVote(e),box=$(".vote-detail",e),voteCount=$("#votes-count",e),talkId=e.data("id"),isChecked=box.data("checked"),box.prop("checked",isChecked),voted=$(".voted",e),box.click(function(){processSubmit(!isChecked,talkId).done(function(e){voteCount.html(e),isChecked=!isChecked,box.prop("checked",isChecked),isChecked?voted.show():voted.hide()})}))},$(document).ready(function(){setTimeout(function(){$(".flash.success").fadeOut(2e3)},6e3)}),$(document).ready(function(){$(".tooltip").tooltipster(),$("a").smoothScroll(),registerForm("#speaker-regestration","#user-regestration"),registerForm("#user-regestration","#speaker-regestration"),registerAjaxRegistration($("#registration")),registerAjaxProfileUpdate($("#talk-registration"),$("#profile-save"),$("#user-form"),$("#talk-form"),$("#talk-button")),registerVotes($("#talks-list")),registerVotesDetail($("#speaker-detail .voting-detail"))}),$(document).ready(function(){var e=$(".show-login-panel-hp");e.click(function(t){e.hide();var o=$("#login-choose-network").show();$.scrollTo(o,500),t.preventDefault()})}),$(document).ready(function(){var e=$(".table-list#users-list tr");e.on("click touchstart",function(){var t=$(this);t.hasClass("active")?t.removeClass("active").find(".crop").removeClass("more"):(e.removeClass("active").find(".crop").removeClass("more"),t.addClass("active").find(".crop").addClass("more"))});var t=$(".table-list#talks-list tr").not(".table-list-sub tr");t.on("click",function(e){var o=$(this),i=o.attr("data-id"),a=t.parent().find(".talks-head"),r=t.parent().find(".talks-detail"),s=t.parent().find('.talks-head[data-id="'+i+'"]'),n=t.parent().find('.talks-detail[data-id="'+i+'"]');return $(e.target).is("a, a img")?void history.replaceState({},document.title,"#talk_"+i):(r.hide(),a.show(),void(o.hasClass("active-detail")?(s.show(),n.hide(),history.replaceState({},document.title,location.href.replace(/#.*/,""))):(s.hide(),n.addClass("active-detail").show(),history.replaceState({},document.title,"#talk_"+i))))}),location.hash.match(/^#talk_[0-9a-f]+$/)&&1==$(location.hash).length&&$(location.hash).click()});