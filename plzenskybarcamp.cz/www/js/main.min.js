registerForm=function(e,t){$("#registration").on("click",e+" .registration-button",function(n){n.preventDefault(),$(this).hide();var o=$(".form",e),r=$(".form",t);o.is(":visible")?(o.hide(),$.scrollTo(e)):(r.hide(),o.show(),$.scrollTo(e,500))})},registerAjaxRegistration=function(e){$(e).on("submit","form",function(t){form=this,t.preventDefault(),action=this.action,$("body").css("cursor","wait"),$.ajax({type:"POST",url:action,data:$(form).serialize()}).done(function(t){t.redirect&&$.ajax({type:"GET",url:t.redirect}).done(function(t){$("body").css("cursor","auto"),e.html(t.html),$.scrollTo(e)})})})},ajaxPost=function(e){return $.ajax({type:"POST",url:e.get(0).action,data:e.serialize()}).promise()},validateForms=function(e){for(index in e)if(!Nette.validateForm(e[index].get(0)))return $.Deferred().reject().promise();return e},commitForms=function(e){return commitForm=function(e){return ajaxPost(e).then(function(e){return e.updated?"Změny byly úspěšně uloženy":$.Deferred().reject("Během uloženi došlo k chybě").promise()})},$.when.apply($,e.map(commitForm))},showMessage=function(e,t){return function(n){n&&(elm=$('<p class="js-message text-center '+t+'">'+n+"</p>"),e.html("").append(elm),$.scrollTo(e,500),setTimeout(function(){elm.hide()},5e3))}},registerAjaxProfileUpdate=function(e,t,n,o,r){e.on("click",function(){o.show(),r.hide()}),t.on("click",function(){t.get(0).disabled=!0,forms=[$("form",n)],o.is(":visible")&&forms.push($("form",o)),unLockSave=function(e){return t.get(0).disabled=!1,e},messageContainer=$("#messages",n),$.when(validateForms(forms)).then(commitForms).then(unLockSave,unLockSave).done(showMessage(messageContainer,"success")).fail(showMessage(messageContainer,"error"))})},processVote=function(e){return actionAdd=e.data("actionAdd"),actionRemove=e.data("actionRemove"),function(e,t){return action=e?actionAdd:actionRemove,$.ajax({type:"GET",url:action,data:"talkId="+t}).promise().then(function(e){return e.votes_count>=0?e.votes_count:$.Deferred().reject().promise()})}},registerVotes=function(e){checkins={},processSubmit=processVote(e),$("tr.talks-detail",e).each(function(e,t){t=$(t),talkId=t.data("id"),checkins[talkId]=$(".vote",t).data("checked"),boxs=[$(".vote",t),$(".vote",t.prev())],$.each(boxs,function(e,n){n.prop("checked",checkins[talkId]),$(n).click(function(e,t,n,o){return function(r){r.preventDefault(),r.stopPropagation(),processSubmit(!checkins[e],e).done(function(r){n.html(r),checkins[e]=!checkins[e],$.each(t,function(t,n){n.prop("checked",checkins[e])}),checkins[e]?o.addClass("voted-for"):o.removeClass("voted-for")})}}(talkId,boxs,$(".votes_count",t),t.prev()))})})},registerVotesDetail=function(e){e.get(0)&&(checkins={},processSubmit=processVote(e),box=$(".vote-detail",e),voteCount=$("#votes-count",e),talkId=e.data("id"),isChecked=box.data("checked"),box.prop("checked",isChecked),voted=$(".voted",e),box.click(function(){processSubmit(!isChecked,talkId).done(function(e){voteCount.html(e),isChecked=!isChecked,box.prop("checked",isChecked),isChecked?voted.show():voted.hide()})}))},$(document).ready(function(){setTimeout(function(){$(".flash.success").fadeOut(2e3)},3e3)}),$(document).ready(function(){$(".tooltip").tooltipster(),$("a").smoothScroll(),registerForm("#speaker-regestration","#user-regestration"),registerForm("#user-regestration","#speaker-regestration"),registerAjaxRegistration($("#registration")),registerAjaxProfileUpdate($("#talk-registration"),$("#profile-save"),$("#user-form"),$("#talk-form"),$("#talk-button")),registerVotes($("#talks-list")),registerVotesDetail($("#speaker-detail .voting-detail"))}),$(document).ready(function(){var e=$(".show-login-panel-hp");e.click(function(t){e.hide();var n=$("#login-choose-network").show();$.scrollTo(n,500),t.preventDefault()})}),$(document).ready(function(){var e=$(".table-list tr");e.on("click touchstart",function(){var t=$(this);t.hasClass("active")?t.removeClass("active").find(".crop").removeClass("more"):(e.removeClass("active").find(".crop").removeClass("more"),t.addClass("active").find(".crop").addClass("more"))});var t=$(".table-list#talks-list tr");t.on("click touchstart",function(e){var n=$(this),o=n.attr("data-id"),r=t.parent().find(".talks-head"),a=t.parent().find(".talks-detail"),i=t.parent().find('.talks-head[data-id="'+o+'"]'),l=t.parent().find('.talks-detail[data-id="'+o+'"]');$(e.target).is("a, a img")||(a.hide(),r.show(),n.hasClass("active-detail-head")?(i.show(),l.hide()):(i.hide(),l.addClass("active-detail").show()),n.hasClass("active-detail")&&(l.hide(),i.show()))})});